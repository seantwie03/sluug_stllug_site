---
import { getCollection } from 'astro:content';
import BaseLayout from '@/layouts/BaseLayout.astro';
import MeetingListing from '@/components/MeetingListing.astro';
import { sortMeetingListByMeetingDate } from '@/buildTimeUtils';
import Pagination from '@/components/Pagination.astro';
import type { GetStaticPaths, InferGetStaticPropsType } from 'astro';

export const getStaticPaths = (async ({ paginate }) => {
    const allMeetings = sortMeetingListByMeetingDate(await getCollection('meetings'));
    return paginate(allMeetings, { pageSize: 24 });
}) satisfies GetStaticPaths;

type Props = InferGetStaticPropsType<typeof getStaticPaths>;

const pageTitle = 'St. Louis Unix/Linux Users Group';

const { page } = Astro.props;
---

<BaseLayout pageTitle={pageTitle}>
    <h3 class="text-center lg:hidden m-0">St. Louis</h3>
    <h1 class="text-center lg:hidden m-0">Unix & Linux</h1>
    <h2 class="text-center lg:hidden m-0 mb-2">Users Groups</h2>
    {
        page.currentPage === 1 && (
            <p class="mb-6">
                The St. Louis Unix and Linux Users Groups hold regular meetings with technical presentations and
                discussions. Our topics frequently involve Unix, Unix-like Operating Systems, Linux, BSD, and other Free
                and Open Source Software (FOSS) applications, products, projects and services. All of our meetings are
                free and open to the public.
            </p>
        )
    }
    {
        page.data.map(({ collection, id, data }) => (
            <MeetingListing
                url={`/${collection}/${id}/`}
                meetingType={data.meetingType}
                meetingDate={data.meetingDate}
                presentations={data.presentations}
                images={data.images}
                meetupUrl={data.meetupUrl}
                youtubeUrl={data.youtubeUrl}
            />
        ))
    }
    <Pagination url={page.url} currentPage={page.currentPage} lastPage={page.lastPage} />
</BaseLayout>
